<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Abfallkalender 2026 — Cuxhaven</title>
<style>
  :root {
    --blue: #2196F3;
    --yellow: #FDD835;
    --gray: #78909C;
    --bg: #f5f5f5;
    --card: #fff;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--bg);
    color: #333;
    min-height: 100vh;
    padding: 1rem;
  }
  header {
    text-align: center;
    padding: 1.5rem 0 1rem;
  }
  header h1 { font-size: 1.6rem; margin-bottom: .25rem; }
  header p { color: #777; font-size: .95rem; }

  .controls {
    max-width: 700px;
    margin: 1rem auto;
    background: var(--card);
    border-radius: 12px;
    padding: 1.25rem;
    box-shadow: 0 1px 4px rgba(0,0,0,.08);
    display: flex;
    flex-wrap: wrap;
    gap: .75rem;
    align-items: end;
  }
  .field { display: flex; flex-direction: column; gap: .3rem; flex: 1; min-width: 140px; }
  .field label { font-size: .8rem; font-weight: 600; color: #555; }
  .field input, .field select {
    padding: .5rem .6rem;
    border: 1px solid #ccc;
    border-radius: 8px;
    font-size: .95rem;
    background: #fafafa;
  }
  .filter-chips {
    display: flex; gap: .5rem; flex-wrap: wrap; width: 100%;
    margin-top: .25rem;
  }
  .chip {
    padding: .4rem .9rem;
    border-radius: 20px;
    border: 2px solid transparent;
    font-size: .85rem;
    font-weight: 600;
    cursor: pointer;
    transition: .15s;
    user-select: none;
  }
  .chip.active { opacity: 1; }
  .chip:not(.active) { opacity: .4; }
  .chip-blau  { background: #e3f2fd; color: #1565C0; border-color: var(--blue); }
  .chip-gelb  { background: #fff9c4; color: #f57f17; border-color: var(--yellow); }
  .chip-grau  { background: #eceff1; color: #37474f; border-color: var(--gray); }

  .next-box {
    max-width: 700px;
    margin: 1rem auto;
    background: linear-gradient(135deg, #e8f5e9, #f1f8e9);
    border-radius: 12px;
    padding: 1.25rem;
    box-shadow: 0 1px 4px rgba(0,0,0,.08);
    text-align: center;
  }
  .next-box h2 { font-size: 1rem; color: #2e7d32; margin-bottom: .5rem; }
  .next-items { display: flex; gap: .6rem; justify-content: center; flex-wrap: wrap; }
  .next-item {
    padding: .5rem 1rem;
    border-radius: 10px;
    font-weight: 600;
    font-size: .95rem;
  }

  .results {
    max-width: 700px;
    margin: 1rem auto;
    display: flex;
    flex-direction: column;
    gap: .5rem;
  }
  .row {
    display: flex;
    align-items: center;
    gap: .75rem;
    padding: .75rem 1rem;
    background: var(--card);
    border-radius: 10px;
    box-shadow: 0 1px 3px rgba(0,0,0,.06);
    border-left: 4px solid transparent;
    transition: .15s;
  }
  .row:hover { transform: translateX(3px); }
  .row.blau  { border-left-color: var(--blue); }
  .row.gelb  { border-left-color: var(--yellow); }
  .row.grau  { border-left-color: var(--gray); }
  .row .dot {
    width: 12px; height: 12px; border-radius: 50%; flex-shrink: 0;
  }
  .row.blau .dot { background: var(--blue); }
  .row.gelb .dot { background: var(--yellow); }
  .row.grau .dot { background: var(--gray); }
  .row .date { font-weight: 600; min-width: 100px; }
  .row .day  { color: #777; min-width: 30px; font-size: .85rem; }
  .row .type { flex: 1; }
  .row .badge {
    font-size: .75rem;
    padding: .2rem .6rem;
    border-radius: 8px;
    background: #e8f5e9;
    color: #2e7d32;
    font-weight: 600;
    white-space: nowrap;
  }
  .row .badge.past { background: #fce4ec; color: #c62828; }

  .count {
    max-width: 700px;
    margin: 0 auto .5rem;
    font-size: .85rem;
    color: #999;
    padding-left: .25rem;
  }

  .empty {
    text-align: center;
    padding: 3rem 1rem;
    color: #999;
    font-size: 1.1rem;
  }

  @media (max-width: 500px) {
    .controls { flex-direction: column; }
    .field { min-width: 100%; }
  }
</style>
</head>
<body>

<header>
  <h1>Abfallkalender 2026</h1>
  <p>Heiddeelweg, Cuxhaven</p>
</header>

<div class="next-box" id="nextBox"></div>

<div class="controls">
  <div class="field">
    <label>Von</label>
    <input type="date" id="dateFrom" value="2026-01-01" min="2026-01-01" max="2026-12-31">
  </div>
  <div class="field">
    <label>Bis</label>
    <input type="date" id="dateTo" value="2026-12-31" min="2026-01-01" max="2026-12-31">
  </div>
  <div class="field">
    <label>Monat</label>
    <select id="monthSelect">
      <option value="">Alle Monate</option>
      <option value="01">Januar</option>
      <option value="02">Februar</option>
      <option value="03">März</option>
      <option value="04">April</option>
      <option value="05">Mai</option>
      <option value="06">Juni</option>
      <option value="07">Juli</option>
      <option value="08">August</option>
      <option value="09">September</option>
      <option value="10">Oktober</option>
      <option value="11">November</option>
      <option value="12">Dezember</option>
    </select>
  </div>
  <div class="filter-chips">
    <span class="chip chip-blau active" data-type="Blaue Tonne" onclick="toggleChip(this)">Blaue Tonne</span>
    <span class="chip chip-gelb active" data-type="Gelbe Tonne" onclick="toggleChip(this)">Gelbe Tonne</span>
    <span class="chip chip-grau active" data-type="Graue Tonne" onclick="toggleChip(this)">Graue Tonne</span>
  </div>
</div>

<div class="count" id="count"></div>
<div class="results" id="results"></div>

<script>
const CSV_DATA = `Datum,Tonne
2026-01-03,Blaue Tonne
2026-01-03,Gelbe Tonne
2026-01-13,Graue Tonne
2026-01-16,Gelbe Tonne
2026-01-29,Blaue Tonne
2026-01-30,Gelbe Tonne
2026-02-10,Graue Tonne
2026-02-13,Gelbe Tonne
2026-02-26,Blaue Tonne
2026-02-27,Gelbe Tonne
2026-03-10,Graue Tonne
2026-03-13,Gelbe Tonne
2026-03-26,Blaue Tonne
2026-03-27,Gelbe Tonne
2026-04-07,Graue Tonne
2026-04-11,Gelbe Tonne
2026-04-23,Blaue Tonne
2026-04-24,Gelbe Tonne
2026-05-05,Graue Tonne
2026-05-09,Gelbe Tonne
2026-05-21,Blaue Tonne
2026-05-22,Gelbe Tonne
2026-06-02,Graue Tonne
2026-06-05,Gelbe Tonne
2026-06-18,Blaue Tonne
2026-06-19,Gelbe Tonne
2026-06-30,Graue Tonne
2026-07-03,Gelbe Tonne
2026-07-16,Blaue Tonne
2026-07-17,Gelbe Tonne
2026-07-28,Graue Tonne
2026-07-31,Gelbe Tonne
2026-08-13,Blaue Tonne
2026-08-14,Gelbe Tonne
2026-08-25,Graue Tonne
2026-08-28,Gelbe Tonne
2026-09-10,Blaue Tonne
2026-09-11,Gelbe Tonne
2026-09-22,Graue Tonne
2026-09-25,Gelbe Tonne
2026-10-08,Blaue Tonne
2026-10-09,Gelbe Tonne
2026-10-20,Graue Tonne
2026-10-23,Gelbe Tonne
2026-11-05,Blaue Tonne
2026-11-06,Gelbe Tonne
2026-11-17,Graue Tonne
2026-11-20,Gelbe Tonne
2026-12-03,Blaue Tonne
2026-12-04,Gelbe Tonne
2026-12-15,Graue Tonne
2026-12-18,Gelbe Tonne
2026-12-31,Blaue Tonne`;

const DAYS = ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'];

const entries = CSV_DATA.trim().split('\n').slice(1).map(line => {
  const [datum, tonne] = line.split(',');
  return { datum, tonne };
});

function today() {
  return new Date().toISOString().slice(0, 10);
}

function formatDate(iso) {
  const [y, m, d] = iso.split('-');
  return `${d}.${m}.${y}`;
}

function dayName(iso) {
  const d = new Date(iso + 'T00:00:00');
  return DAYS[d.getDay()];
}

function typeClass(tonne) {
  if (tonne.startsWith('Blaue')) return 'blau';
  if (tonne.startsWith('Gelbe')) return 'gelb';
  return 'grau';
}

function activeTypes() {
  return [...document.querySelectorAll('.chip.active')].map(c => c.dataset.type);
}

function toggleChip(el) {
  el.classList.toggle('active');
  render();
}

function renderNext() {
  const t = today();
  const types = ['Blaue Tonne', 'Gelbe Tonne', 'Graue Tonne'];
  const nextByType = types.map(type => {
    const entry = entries.find(e => e.tonne === type && e.datum >= t);
    return entry ? { ...entry } : null;
  }).filter(Boolean);

  const box = document.getElementById('nextBox');
  if (nextByType.length === 0) {
    box.innerHTML = '<h2>Keine weiteren Termine in 2026</h2>';
    return;
  }

  const items = nextByType.map(e => {
    const daysLeft = Math.ceil((new Date(e.datum + 'T00:00:00') - new Date(t + 'T00:00:00')) / 86400000);
    const label = daysLeft === 0 ? 'heute' : daysLeft === 1 ? 'morgen' : `in ${daysLeft} Tagen`;
    return `<div class="next-item" style="background:${
      e.tonne.startsWith('Blaue') ? '#bbdefb' : e.tonne.startsWith('Gelbe') ? '#fff9c4' : '#cfd8dc'
    }">${e.tonne}<br><small>${formatDate(e.datum)} (${dayName(e.datum)}) — ${label}</small></div>`;
  }).join('');

  box.innerHTML = `<h2>Nächste Abholtermine</h2><div class="next-items">${items}</div>`;
}

function render() {
  const from = document.getElementById('dateFrom').value;
  const to = document.getElementById('dateTo').value;
  const month = document.getElementById('monthSelect').value;
  const types = activeTypes();
  const t = today();

  let filtered = entries.filter(e => {
    if (e.datum < from || e.datum > to) return false;
    if (month && e.datum.slice(5, 7) !== month) return false;
    if (!types.includes(e.tonne)) return false;
    return true;
  });

  const container = document.getElementById('results');
  const countEl = document.getElementById('count');

  if (filtered.length === 0) {
    container.innerHTML = '<div class="empty">Keine Termine gefunden.</div>';
    countEl.textContent = '';
    return;
  }

  countEl.textContent = `${filtered.length} Termine`;

  container.innerHTML = filtered.map(e => {
    const cls = typeClass(e.tonne);
    const past = e.datum < t;
    return `<div class="row ${cls}">
      <span class="dot"></span>
      <span class="day">${dayName(e.datum)}</span>
      <span class="date">${formatDate(e.datum)}</span>
      <span class="type">${e.tonne}</span>
      ${past ? '<span class="badge past">vergangen</span>' : e.datum === t ? '<span class="badge">heute</span>' : ''}
    </div>`;
  }).join('');
}

// Month shortcut: selecting a month updates date range
document.getElementById('monthSelect').addEventListener('change', function() {
  const m = this.value;
  if (m) {
    document.getElementById('dateFrom').value = `2026-${m}-01`;
    const last = new Date(2026, parseInt(m), 0).getDate();
    document.getElementById('dateTo').value = `2026-${m}-${String(last).padStart(2,'0')}`;
  } else {
    document.getElementById('dateFrom').value = '2026-01-01';
    document.getElementById('dateTo').value = '2026-12-31';
  }
  render();
});

document.getElementById('dateFrom').addEventListener('change', () => { document.getElementById('monthSelect').value = ''; render(); });
document.getElementById('dateTo').addEventListener('change', () => { document.getElementById('monthSelect').value = ''; render(); });

renderNext();
render();
</script>
</body>
</html>
